/* ============================================
   ВИТРИНА РАЗБИТА — Main Stylesheet v8.1.0
   Оптимизированная версия
   ============================================ */

/* === RESET & BASE === */
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
html{font-size:16px;-webkit-tap-highlight-color:transparent;-webkit-text-size-adjust:100%;scroll-behavior:smooth}
body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,Oxygen,Ubuntu,sans-serif;background:#0a0a0a;color:#fff;min-height:100vh;min-height:100dvh;overflow-x:hidden;line-height:1.5;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}
a{color:#4daaff;text-decoration:none;transition:color .2s}
a:hover{color:#7cc4ff}
button{font:inherit;cursor:pointer;border:none;background:none;color:inherit;-webkit-tap-highlight-color:transparent}
button:focus-visible{outline:2px solid #4daaff;outline-offset:2px}
img{max-width:100%;height:auto;display:block;-webkit-user-drag:none;user-select:none}
input,textarea{font:inherit;color:inherit;background:transparent;border:1px solid rgba(255,255,255,.2);border-radius:8px;padding:10px 14px}
input:focus,textarea:focus{outline:none;border-color:#4daaff}
ul,ol{list-style:none}
h1,h2,h3,h4,h5,h6{font-weight:600;line-height:1.3}

/* === SCROLLBAR === */
::-webkit-scrollbar{width:6px;height:6px}
::-webkit-scrollbar-track{background:rgba(255,255,255,.05)}
::-webkit-scrollbar-thumb{background:rgba(255,255,255,.2);border-radius:3px}
::-webkit-scrollbar-thumb:hover{background:rgba(255,255,255,.3)}
*{scrollbar-width:thin;scrollbar-color:rgba(255,255,255,.2) transparent}

/* === SELECTION === */
::selection{background:#E80100;color:#fff}
::-moz-selection{background:#E80100;color:#fff}

/* === LAYOUT === */
.app-container{display:flex;flex-direction:column;min-height:100vh;min-height:100dvh;max-width:100vw;position:relative}
.main-content{flex:1;display:flex;flex-direction:column;padding:16px;gap:20px;padding-bottom:200px;max-width:1400px;margin:0 auto;width:100%}

@media(min-width:768px){
  .main-content{flex-direction:row;padding:24px;gap:32px;padding-bottom:220px}
}
@media(min-width:1200px){
  .main-content{padding:32px 48px}
}

/* === HEADER === */
.app-header{display:flex;align-items:center;justify-content:space-between;padding:12px 16px;background:linear-gradient(180deg,rgba(20,20,20,.98),rgba(10,10,10,.95));position:sticky;top:0;z-index:100;backdrop-filter:blur(12px);-webkit-backdrop-filter:blur(12px);border-bottom:1px solid rgba(255,255,255,.05)}
.logo{height:40px;width:auto;transition:transform .2s}
.logo:hover{transform:scale(1.05)}
.logo:active{transform:scale(.95)}
.header-actions{display:flex;gap:8px;align-items:center}
.header-btn{position:relative;width:40px;height:40px;border-radius:50%;background:rgba(255,255,255,.08);display:flex;align-items:center;justify-content:center;font-size:18px;transition:all .2s}
.header-btn:hover{background:rgba(255,255,255,.15);transform:scale(1.05)}
.header-btn:active{transform:scale(.95)}
.header-btn.active{background:#E80100;color:#fff}

@media(min-width:768px){
  .app-header{padding:16px 24px}
  .logo{height:48px}
  .header-btn{width:44px;height:44px;font-size:20px}
}

/* === ALBUM ICONS === */
.album-icons-section{width:100%}
.album-icons{display:flex;gap:12px;overflow-x:auto;padding:8px 4px;scrollbar-width:none;-ms-overflow-style:none;scroll-snap-type:x mandatory;-webkit-overflow-scrolling:touch}
.album-icons::-webkit-scrollbar{display:none}
.album-icon-item{flex-shrink:0;width:72px;text-align:center;cursor:pointer;transition:transform .2s;scroll-snap-align:start}
.album-icon-item:hover{transform:scale(1.08)}
.album-icon-item:active{transform:scale(.95)}
.album-icon-item img{width:72px;height:72px;border-radius:14px;object-fit:cover;box-shadow:0 4px 16px rgba(0,0,0,.5);transition:box-shadow .2s}
.album-icon-item:hover img{box-shadow:0 6px 24px rgba(232,1,0,.3)}
.album-icon-title{font-size:10px;margin-top:6px;color:#999;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;padding:0 2px;transition:color .2s}
.album-icon-item:hover .album-icon-title{color:#fff}

@media(min-width:768px){
  .album-icons{gap:16px;padding:12px 4px}
  .album-icon-item{width:90px}
  .album-icon-item img{width:90px;height:90px;border-radius:16px}
  .album-icon-title{font-size:11px;margin-top:8px}
}

/* === COVER GALLERY === */
.cover-section{flex-shrink:0;width:100%}
@media(min-width:768px){.cover-section{width:320px;min-width:280px}}
@media(min-width:1024px){.cover-section{width:380px}}

#cover-wrap{position:relative;aspect-ratio:1;border-radius:20px;overflow:hidden;background:linear-gradient(135deg,#1a1a1a,#0d0d0d);box-shadow:0 8px 40px rgba(0,0,0,.5)}
#cover-slot{width:100%;height:100%;display:flex;align-items:center;justify-content:center}
#cover-slot img,#cover-slot picture{width:100%;height:100%;object-fit:cover;transition:opacity .3s}
#cover-slot picture img{width:100%;height:100%;object-fit:cover}
#cover-slot iframe{width:100%;height:100%;border:none;background:#000}

.gallery-arrow{position:absolute;top:50%;transform:translateY(-50%);width:44px;height:44px;background:rgba(0,0,0,.7);border-radius:50%;display:none;align-items:center;justify-content:center;font-size:24px;color:#fff;z-index:10;transition:all .2s;backdrop-filter:blur(4px);opacity:0}
.gallery-arrow:hover{background:rgba(232,1,0,.8);transform:translateY(-50%) scale(1.1)}
.gallery-arrow:active{transform:translateY(-50%) scale(.95)}
#cover-gallery-arrow-left{left:12px}
#cover-gallery-arrow-right{right:12px}

#cover-wrap:hover .gallery-arrow,.gallery-nav-ready .gallery-arrow{display:flex;opacity:1}
.gallery-nav-ready #cover-wrap{cursor:grab}

/* === TRACKS SECTION === */
.tracks-section{flex:1;min-width:0;display:flex;flex-direction:column}
.album-header{margin-bottom:16px;padding-bottom:12px;border-bottom:1px solid rgba(255,255,255,.1)}
#album-title{font-size:20px;font-weight:700;margin-bottom:4px;background:linear-gradient(90deg,#fff,#ccc);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}
#album-artist{font-size:14px;color:#888}

@media(min-width:768px){
  #album-title{font-size:24px}
  #album-artist{font-size:15px}
}

#track-list{display:flex;flex-direction:column;gap:6px;max-height:50vh;overflow-y:auto;padding-right:4px}
@media(min-width:768px){#track-list{max-height:60vh}}

.track-item{display:flex;align-items:center;gap:12px;padding:12px 14px;background:rgba(255,255,255,.04);border-radius:12px;cursor:pointer;transition:all .2s;border:1px solid transparent}
.track-item:hover{background:rgba(255,255,255,.08);border-color:rgba(255,255,255,.1);transform:translateX(4px)}
.track-item:active{transform:scale(.98)}
.track-item.playing{background:linear-gradient(90deg,rgba(232,1,0,.15),rgba(232,1,0,.05));border-color:rgba(232,1,0,.3)}
.track-item.playing .track-title{color:#ff6b6b}
.track-item.playing .track-num{color:#E80100}

.track-num{width:28px;text-align:center;color:#555;font-size:14px;font-weight:500;flex-shrink:0}
.track-info{flex:1;min-width:0;display:flex;flex-direction:column;gap:2px}
.track-title{font-weight:500;font-size:15px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;transition:color .2s}
.track-artist{font-size:13px;color:#777;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.track-duration{font-size:12px;color:#666;flex-shrink:0;margin-left:8px}

.track-fav-btn{width:36px;height:36px;font-size:18px;opacity:.5;transition:all .2s;border-radius:50%;flex-shrink:0}
.track-fav-btn:hover{opacity:1;background:rgba(255,255,255,.1);transform:scale(1.15)}
.track-fav-btn.active{opacity:1;color:#ffd700}
.track-fav-btn.active:hover{color:#ffed4a}

.empty-message{text-align:center;padding:60px 20px;color:#555;font-size:15px;line-height:1.8}
.empty-message strong{color:#888;display:block;margin-bottom:8px}

/* === PLAYER BAR === */
.player-bar{position:fixed;bottom:0;left:0;right:0;background:linear-gradient(180deg,rgba(18,18,18,.98),rgba(8,8,8,.99));padding:16px 16px calc(16px + env(safe-area-inset-bottom));z-index:200;backdrop-filter:blur(24px);-webkit-backdrop-filter:blur(24px);border-top:1px solid rgba(255,255,255,.08);box-shadow:0 -4px 30px rgba(0,0,0,.5)}

.player-track-info{text-align:center;margin-bottom:12px}
#track-title{font-weight:600;font-size:15px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;margin-bottom:2px}
#track-artist{font-size:13px;color:#888;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}

.progress-container{display:flex;align-items:center;gap:12px;margin-bottom:14px}
#progress-bar{flex:1;height:6px;background:rgba(255,255,255,.15);border-radius:3px;cursor:pointer;position:relative;overflow:hidden;transition:height .15s}
#progress-bar:hover{height:8px}
#progress-fill{height:100%;background:linear-gradient(90deg,#E80100,#ff4444);border-radius:3px;width:0;transition:width .1s linear;position:relative}
#progress-fill::after{content:'';position:absolute;right:-6px;top:50%;transform:translateY(-50%);width:12px;height:12px;background:#fff;border-radius:50%;box-shadow:0 2px 8px rgba(0,0,0,.3);opacity:0;transition:opacity .15s}
#progress-bar:hover #progress-fill::after{opacity:1}

.time{font-size:12px;color:#777;min-width:42px;font-variant-numeric:tabular-nums}
#time-current{text-align:right}
#time-total{text-align:left}

.player-controls{display:flex;align-items:center;justify-content:center;gap:6px;flex-wrap:wrap}
.control-btn{width:44px;height:44px;border-radius:50%;background:rgba(255,255,255,.08);display:flex;align-items:center;justify-content:center;font-size:18px;transition:all .2s}
.control-btn:hover{background:rgba(255,255,255,.15);transform:scale(1.1)}
.control-btn:active{transform:scale(.9)}
.control-btn.active{color:#4daaff}
.control-btn.active:hover{color:#7cc4ff}

#play-pause-btn{width:56px;height:56px;font-size:24px;background:linear-gradient(135deg,#E80100,#c70000);box-shadow:0 4px 20px rgba(232,1,0,.4)}
#play-pause-btn:hover{background:linear-gradient(135deg,#ff2020,#E80100);transform:scale(1.1);box-shadow:0 6px 28px rgba(232,1,0,.5)}
#play-pause-btn:active{transform:scale(.95)}

.volume-container{display:flex;align-items:center;gap:10px;margin-top:12px;justify-content:center}
#volume-bar{width:100px;height:4px;background:rgba(255,255,255,.15);border-radius:2px;cursor:pointer;position:relative;transition:height .15s}
#volume-bar:hover{height:6px}
#volume-fill{height:100%;background:linear-gradient(90deg,#4daaff,#7cc4ff);border-radius:2px;width:100%;transition:width .1s}
#volume-icon{font-size:18px;cursor:pointer;transition:transform .2s;width:24px;text-align:center}
#volume-icon:hover{transform:scale(1.2)}

@media(min-width:768px){
  .player-bar{padding:20px 32px calc(20px + env(safe-area-inset-bottom))}
  .player-controls{gap:10px}
  .control-btn{width:48px;height:48px;font-size:20px}
  #play-pause-btn{width:64px;height:64px;font-size:28px}
  #volume-bar{width:120px}
}

/* === LYRICS PANEL === */
#lyrics-panel{position:fixed;bottom:180px;left:0;right:0;max-height:35vh;background:linear-gradient(180deg,rgba(15,15,15,.98),rgba(10,10,10,.99));transform:translateY(calc(100% + 20px));transition:transform .3s cubic-bezier(.4,0,.2,1);overflow:hidden;z-index:150;border-top:1px solid rgba(255,255,255,.1);backdrop-filter:blur(16px);-webkit-backdrop-filter:blur(16px)}
#lyrics-panel.visible{transform:translateY(0)}

@media(min-width:768px){#lyrics-panel{bottom:200px;max-height:40vh}}

#lyrics-box{height:100%;overflow-y:auto;padding:20px;text-align:center;scroll-behavior:smooth}
.lyrics-line{padding:10px 16px;color:#666;transition:all .3s;font-size:15px;line-height:1.6;border-radius:8px}
.lyrics-line:hover{color:#999;background:rgba(255,255,255,.03)}
.lyrics-line.active{color:#fff;font-size:18px;font-weight:600;background:rgba(232,1,0,.1);transform:scale(1.02)}
.lyrics-empty{color:#555;padding:40px;font-size:15px}

/* === MODALS === */
.modal-bg{position:fixed;inset:0;background:rgba(0,0,0,.9);display:flex;align-items:center;justify-content:center;z-index:1000;opacity:0;pointer-events:none;transition:opacity .25s;padding:20px;backdrop-filter:blur(8px);-webkit-backdrop-filter:blur(8px)}
.modal-bg.active{opacity:1;pointer-events:auto}

.modal-feedback{background:linear-gradient(180deg,#1e1e1e,#151515);border-radius:20px;padding:28px;max-width:90vw;width:480px;max-height:85vh;overflow-y:auto;position:relative;box-shadow:0 20px 60px rgba(0,0,0,.6);border:1px solid rgba(255,255,255,.08);animation:modalIn .3s}
@keyframes modalIn{from{opacity:0;transform:scale(.9) translateY(20px)}}

.modal-feedback h2,.modal-feedback h3{margin-bottom:16px;font-size:20px}
.modal-feedback p{color:#aaa;line-height:1.7;margin-bottom:12px}

.bigclose{position:absolute;top:16px;right:16px;width:36px;height:36px;font-size:24px;opacity:.5;transition:all .2s;border-radius:50%;display:flex;align-items:center;justify-content:center}
.bigclose:hover{opacity:1;background:rgba(255,255,255,.1);transform:rotate(90deg)}

.modal-action-btn{background:linear-gradient(135deg,#E80100,#c70000);color:#fff;padding:14px 28px;border-radius:12px;font-weight:600;font-size:15px;transition:all .2s;border:none;cursor:pointer}
.modal-action-btn:hover{background:linear-gradient(135deg,#ff2020,#E80100);transform:translateY(-2px);box-shadow:0 6px 20px rgba(232,1,0,.4)}
.modal-action-btn:active{transform:translateY(0)}
.modal-action-btn.secondary{background:rgba(255,255,255,.1)}
.modal-action-btn.secondary:hover{background:rgba(255,255,255,.2);box-shadow:none}

.offline-btn{background:rgba(255,255,255,.1);color:#fff;padding:12px 24px;border-radius:10px;font-weight:500;transition:all .2s}
.offline-btn:hover{background:rgba(255,255,255,.2)}
.offline-btn.online{background:linear-gradient(135deg,#4daaff,#2196f3)}
.offline-btn.online:hover{background:linear-gradient(135deg,#7cc4ff,#4daaff)}

/* === NOTIFICATIONS === */
.notification-container{position:fixed;top:70px;right:16px;z-index:2000;display:flex;flex-direction:column;gap:10px;max-width:340px;pointer-events:none}
@media(max-width:480px){.notification-container{left:16px;right:16px;max-width:none}}

.notification{padding:14px 18px;border-radius:14px;background:rgba(30,30,30,.95);box-shadow:0 8px 32px rgba(0,0,0,.4);animation:notifyIn .4s cubic-bezier(.4,0,.2,1);pointer-events:auto;display:flex;align-items:flex-start;gap:12px;backdrop-filter:blur(12px);-webkit-backdrop-filter:blur(12px);border:1px solid rgba(255,255,255,.08)}
@keyframes notifyIn{from{opacity:0;transform:translateX(100%) scale(.8)}}

.notification-content{flex:1;font-size:14px;line-height:1.5}
.notification-close{width:24px;height:24px;font-size:18px;opacity:.5;transition:opacity .2s;flex-shrink:0}
.notification-close:hover{opacity:1}

.notification.success{border-left:4px solid #4caf50}
.notification.success::before{content:'✓';color:#4caf50;font-weight:bold}
.notification.error{border-left:4px solid #f44336}
.notification.error::before{content:'✕';color:#f44336;font-weight:bold}
.notification.warning{border-left:4px solid #ff9800}
.notification.warning::before{content:'⚠';color:#ff9800}
.notification.info{border-left:4px solid #2196f3}
.notification.info::before{content:'ℹ';color:#2196f3}

/* === SLEEP MENU === */
.sleep-menu{background:rgba(25,25,25,.98);border-radius:16px;padding:8px 0;box-shadow:0 12px 48px rgba(0,0,0,.7);min-width:160px;z-index:500;border:1px solid rgba(255,255,255,.1);backdrop-filter:blur(16px);-webkit-backdrop-filter:blur(16px);animation:menuIn .2s}
@keyframes menuIn{from{opacity:0;transform:scale(.9)}}

.sleep-menu-item{padding:12px 20px;cursor:pointer;transition:all .2s;font-size:14px}
.sleep-menu-item:hover{background:rgba(255,255,255,.1)}
.sleep-menu-item:active{background:rgba(255,255,255,.15)}
.sleep-menu-item.active{color:#4daaff;font-weight:500}

#sleep-timer-badge{position:absolute;top:-2px;right:-2px;background:linear-gradient(135deg,#E80100,#ff4444);color:#fff;font-size:10px;font-weight:700;min-width:20px;height:20px;border-radius:10px;display:flex;align-items:center;justify-content:center;padding:0 5px;box-shadow:0 2px 8px rgba(232,1,0,.5);animation:badgePulse 2s infinite}
@keyframes badgePulse{0%,100%{transform:scale(1)}50%{transform:scale(1.1)}}

/* === NEWS === */
.news-item{padding:20px;background:rgba(255,255,255,.04);border-radius:14px;margin-bottom:14px;border:1px solid rgba(255,255,255,.06);transition:all .2s}
.news-item:hover{background:rgba(255,255,255,.06);border-color:rgba(255,255,255,.1)}
.news-date{font-size:12px;color:#666;margin-bottom:6px;text-transform:uppercase;letter-spacing:.5px}
.news-title{font-weight:600;font-size:17px;margin-bottom:10px;color:#fff}
.news-text{font-size:14px;color:#aaa;line-height:1.7}

/* === DOWNLOAD PROGRESS === */
.download-progress{background:rgba(255,255,255,.05);border-radius:8px;padding:12px;margin-top:12px}
.download-progress-bar{height:4px;background:rgba(255,255,255,.1);border-radius:2px;overflow:hidden}
.download-progress-fill{height:100%;background:linear-gradient(90deg,#4daaff,#7cc4ff);width:0;transition:width .3s}
.download-progress-text{font-size:12px;color:#888;margin-top:8px;text-align:center}

/* === UTILITIES === */
.hidden{display:none!important}
.visually-hidden{position:absolute;width:1px;height:1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap}
.no-select{-webkit-user-select:none;user-select:none}
.truncate{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}

/* === OFFLINE STATE === */
.offline .online-only{display:none!important}
body.offline::before{content:'';position:fixed;top:0;left:0;right:0;height:3px;background:linear-gradient(90deg,#ff9800,#f57c00);z-index:3000;animation:offlineBar 2s infinite}
@keyframes offlineBar{0%,100%{opacity:1}50%{opacity:.5}}

.offline-indicator{position:fixed;top:60px;left:50%;transform:translateX(-50%);background:linear-gradient(135deg,#ff9800,#f57c00);color:#000;padding:8px 20px;border-radius:20px;font-size:13px;font-weight:600;z-index:2500;box-shadow:0 4px 16px rgba(255,152,0,.4);display:none}
body.offline .offline-indicator{display:block;animation:slideDown .3s}
@keyframes slideDown{from{opacity:0;transform:translateX(-50%) translateY(-20px)}}

/* === iOS SPECIFIC === */
body.ios{-webkit-touch-callout:none}
body.ios .player-bar{padding-bottom:calc(20px + env(safe-area-inset-bottom))}
body.ios #lyrics-panel{bottom:calc(180px + env(safe-area-inset-bottom))}

/* === STANDALONE (PWA) === */
body.standalone .app-header{padding-top:calc(12px + env(safe-area-inset-top))}
@media(display-mode:standalone){
  .install-prompt{display:none!important}
}

/* === LOADING STATES === */
.skeleton{background:linear-gradient(90deg,rgba(255,255,255,.05) 25%,rgba(255,255,255,.1) 50%,rgba(255,255,255,.05) 75%);background-size:200% 100%;animation:skeleton 1.5s infinite}
@keyframes skeleton{0%{background-position:200% 0}100%{background-position:-200% 0}}

.loading-spinner{width:40px;height:40px;border:3px solid rgba(255,255,255,.1);border-top-color:#E80100;border-radius:50%;animation:spin 1s linear infinite}
@keyframes spin{to{transform:rotate(360deg)}}

/* === FOCUS STYLES (Accessibility) === */
.track-item:focus-visible,.album-icon-item:focus-visible,.control-btn:focus-visible{outline:2px solid #4daaff;outline-offset:2px}

/* === REDUCED MOTION === */
@media(prefers-reduced-motion:reduce){
  *,*::before,*::after{animation-duration:.01ms!important;animation-iteration-count:1!important;transition-duration:.01ms!important}
  html{scroll-behavior:auto}
}

/* === HIGH CONTRAST === */
@media(prefers-contrast:high){
  .track-item{border:1px solid rgba(255,255,255,.3)}
  .control-btn{border:1px solid rgba(255,255,255,.3)}
  #progress-bar,#volume-bar{background:rgba(255,255,255,.3)}
}

/* === PRINT === */
@media print{
  .player-bar,.app-header,.modal-bg,.notification-container,#lyrics-panel{display:none!important}
  body{background:#fff;color:#000}
  .track-item{border:1px solid #ccc;break-inside:avoid}
}
