/* ============================================
   OFFLINE UI STYLES — ТЗ v1.0
   ============================================ */

/* ===== Overlays ===== */
.ofl-overlay, .stats-overlay, .s2-overlay, .r3m-overlay {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.88);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 10000;
  padding: 12px;
  -webkit-overflow-scrolling: touch;
}

/* ===== OFFLINE MODAL ===== */
.ofl-content {
  background: #1a1a2e;
  border-radius: 14px;
  width: 100%;
  max-width: 480px;
  max-height: 88vh;
  overflow-y: auto;
  color: #e0e0e0;
  font-size: 14px;
  box-shadow: 0 8px 40px rgba(0,0,0,0.6);
  -webkit-overflow-scrolling: touch;
}
.ofl-hdr {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 14px 18px 10px;
  border-bottom: 1px solid rgba(255,255,255,0.1);
  position: sticky;
  top: 0;
  background: #1a1a2e;
  z-index: 2;
}
.ofl-hdr h2 { margin: 0; font-size: 17px; color: #fff; }
.ofl-close {
  background: none; border: none; color: #999;
  font-size: 22px; cursor: pointer; padding: 4px 8px;
}
.ofl-close:hover { color: #fff; }
.ofl-body { padding: 10px 18px 18px; }

/* Sections */
.ofl-sec {
  margin-bottom: 18px;
  padding-bottom: 14px;
  border-bottom: 1px solid rgba(255,255,255,0.06);
}
.ofl-sec:last-child { border-bottom: none; margin-bottom: 0; }
.ofl-sec h3 {
  margin: 0 0 10px;
  font-size: 14px;
  color: #4fc3f7;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}
.ofl-sub { margin: 10px 0; }
.ofl-sub h4 { margin: 0 0 6px; font-size: 13px; color: #90caf9; }

/* Row */
.ofl-row {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 5px 0;
  min-height: 32px;
}
.ofl-row span { font-size: 13px; }

/* Hint */
.ofl-hint {
  font-size: 11px;
  color: #777;
  margin: 4px 0 0;
  line-height: 1.4;
}

/* Toggle Switch */
.ofl-sw {
  position: relative;
  display: inline-block;
  width: 42px; height: 22px;
  flex-shrink: 0;
}
.ofl-sw input { opacity: 0; width: 0; height: 0; position: absolute; }
.ofl-sl {
  position: absolute; cursor: pointer; inset: 0;
  background: #555; border-radius: 22px;
  transition: background 0.25s;
}
.ofl-sl::before {
  content: '';
  position: absolute;
  width: 16px; height: 16px;
  left: 3px; bottom: 3px;
  background: #fff; border-radius: 50%;
  transition: transform 0.25s;
}
.ofl-sw input:checked + .ofl-sl { background: #43a047; }
.ofl-sw input:checked + .ofl-sl::before { transform: translateX(20px); }
.ofl-sw input:disabled + .ofl-sl { opacity: 0.35; cursor: not-allowed; }

/* Radio */
.ofl-rr { display: flex; gap: 14px; padding: 4px 0; }
.ofl-rl {
  display: flex; align-items: center; gap: 5px;
  cursor: pointer; font-size: 13px;
}
.ofl-rl input[type="radio"] { accent-color: #43a047; }

/* Input row */
.ofl-ir {
  display: flex; align-items: center; gap: 8px; padding: 3px 0;
}
.ofl-ir label { white-space: nowrap; font-size: 12px; }
.ofl-ir input[type="number"] {
  width: 64px; padding: 3px 6px;
  background: #252540; border: 1px solid #444;
  border-radius: 6px; color: #fff; font-size: 13px;
}

/* Buttons */
.ofl-btn {
  padding: 7px 14px;
  border: 1px solid #555;
  background: #252540;
  color: #ddd;
  border-radius: 8px;
  cursor: pointer;
  font-size: 12px;
  transition: background 0.2s;
  white-space: nowrap;
}
.ofl-btn:hover { background: #353550; }
.ofl-btn:disabled { opacity: 0.35; cursor: not-allowed; }
.ofl-btn:active { transform: scale(0.97); }

.ofl-p { background: #1b5e20; border-color: #2e7d32; color: #fff; }
.ofl-p:hover { background: #2e7d32; }
.ofl-w { border-color: #e65100; color: #ffab40; }
.ofl-w:hover { background: #3e2723; }
.ofl-d { border-color: #b71c1c; color: #ef9a9a; }
.ofl-d:hover { background: #3e1111; }

.ofl-br { display: flex; gap: 8px; margin-top: 6px; }
.ofl-bc { display: flex; flex-direction: column; gap: 6px; }

/* Small buttons (tracklist) */
.ofl-bs {
  padding: 3px 8px;
  border: 1px solid #555;
  background: #252540;
  color: #ccc;
  border-radius: 5px;
  cursor: pointer;
  font-size: 11px;
}
.ofl-bs:hover { background: #353550; }
.ofl-bs:disabled { opacity: 0.3; cursor: not-allowed; }

/* Select */
.ofl-sel {
  width: 100%;
  padding: 6px 8px;
  background: #252540;
  border: 1px solid #444;
  border-radius: 6px;
  color: #fff;
  font-size: 13px;
}

/* Breakdown */
.ofl-bd {
  font-size: 12px;
  line-height: 1.6;
  color: #aaa;
  padding: 8px 0;
  font-family: monospace;
}

/* Progress bar */
.ofl-pb {
  height: 6px;
  background: #333;
  border-radius: 3px;
  overflow: hidden;
  margin: 6px 0;
}
.ofl-pf {
  height: 100%;
  background: linear-gradient(90deg, #43a047, #66bb6a);
  border-radius: 3px;
  width: 0%;
  transition: width 0.4s;
}

/* FO Tracklist */
.ofl-fotl {
  max-height: 200px;
  overflow-y: auto;
  border: 1px solid rgba(255,255,255,0.06);
  border-radius: 8px;
  padding: 4px;
}
.ofl-fot {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 5px 6px;
  border-bottom: 1px solid rgba(255,255,255,0.04);
  font-size: 12px;
  gap: 6px;
}
.ofl-fot:last-child { border-bottom: none; }
.ofl-fot div { display: flex; gap: 4px; flex-shrink: 0; }

/* ===== STATISTICS MODAL ===== */
.stats-content {
  background: #1a1a2e;
  border-radius: 14px;
  width: 100%;
  max-width: 440px;
  max-height: 80vh;
  overflow-y: auto;
  color: #e0e0e0;
  font-size: 14px;
  box-shadow: 0 8px 40px rgba(0,0,0,0.6);
}
.stats-hdr {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 14px 18px 10px;
  border-bottom: 1px solid rgba(255,255,255,0.1);
  position: sticky; top: 0;
  background: #1a1a2e; z-index: 2;
}
.stats-hdr h2 { margin: 0; font-size: 17px; color: #fff; }
.stats-close {
  background: none; border: none; color: #999;
  font-size: 22px; cursor: pointer; padding: 4px 8px;
}
.stats-close:hover { color: #fff; }
.stats-body { padding: 12px 18px 18px; }

.stats-trigger-btn {
  display: block;
  margin: 8px auto;
  background: none;
  border: 1px solid rgba(255,255,255,0.15);
  border-radius: 50%;
  width: 36px; height: 36px;
  font-size: 18px;
  cursor: pointer;
  color: #aaa;
  transition: color 0.2s, border-color 0.2s;
}
.stats-trigger-btn:hover { color: #fff; border-color: rgba(255,255,255,0.4); }

.stats-empty {
  text-align: center;
  padding: 20px;
  color: #888;
}
.stats-list { margin-bottom: 16px; }
.stats-item {
  display: flex;
  align-items: flex-start;
  gap: 10px;
  padding: 8px 0;
  border-bottom: 1px solid rgba(255,255,255,0.05);
}
.stats-item:last-child { border-bottom: none; }
.stats-rank {
  color: #4fc3f7;
  font-weight: bold;
  font-size: 16px;
  min-width: 24px;
  text-align: right;
}
.stats-info { display: flex; flex-direction: column; gap: 2px; }
.stats-title { font-size: 13px; color: #fff; }
.stats-detail { font-size: 11px; color: #888; }
.stats-total {
  padding: 12px 0 0;
  border-top: 1px solid rgba(255,255,255,0.1);
  font-size: 13px;
  color: #aaa;
  text-align: center;
}

/* ===== S2 MODAL (Network lost) ===== */
.s2-content {
  background: #1a1a2e;
  border-radius: 14px;
  padding: 24px;
  width: 100%;
  max-width: 380px;
  text-align: center;
  color: #e0e0e0;
}
.s2-content h3 { margin: 0 0 10px; color: #ef5350; font-size: 16px; }
.s2-content p { margin: 0 0 16px; font-size: 13px; color: #bbb; }
.s2-actions { display: flex; flex-direction: column; gap: 10px; }
.s2-btn {
  padding: 10px 16px;
  border: 1px solid #555;
  background: #252540;
  color: #ddd;
  border-radius: 10px;
  cursor: pointer;
  font-size: 13px;
  transition: background 0.2s;
}
.s2-btn:hover { background: #353550; }
.s2-btn-wait { border-color: #4fc3f7; color: #4fc3f7; }
.s2-btn-skip { border-color: #43a047; color: #81c784; }
.s2-btn-settings { border-color: #ffab40; color: #ffab40; }
.s2-recommend { text-align: left; font-size: 12px; color: #999; line-height: 1.5; }
.s2-recommend p { margin: 4px 0; }

/* ===== R3 MODAL ===== */
.r3m-content {
  background: #1a1a2e;
  border-radius: 14px;
  padding: 24px;
  width: 100%;
  max-width: 380px;
  text-align: center;
  color: #e0e0e0;
}
.r3m-content h3 { margin: 0 0 10px; color: #4fc3f7; font-size: 16px; }
.r3m-content p { margin: 0 0 16px; font-size: 13px; color: #bbb; }
.r3m-actions { display: flex; flex-direction: column; gap: 8px; }
.r3m-btn {
  padding: 9px 14px;
  border: 1px solid #555;
  background: #252540;
  color: #ddd;
  border-radius: 10px;
  cursor: pointer;
  font-size: 13px;
}
.r3m-btn:hover { background: #353550; }

/* ===== QUALITY BUTTON ===== */
.quality-btn {
  min-width: 36px;
  height: 36px;
  border: 2px solid;
  border-radius: 8px;
  font-weight: bold;
  font-size: 13px;
  cursor: pointer;
  background: transparent;
  transition: all 0.2s;
  padding: 0 8px;
  line-height: 32px;
  text-align: center;
}
.quality-hi {
  color: #43a047;
  border-color: #43a047;
}
.quality-hi:hover { background: rgba(67,160,71,0.15); }
.quality-lo {
  color: #ff9800;
  border-color: #ff9800;
}
.quality-lo:hover { background: rgba(255,152,0,0.15); }
.quality-disabled {
  color: #666;
  border-color: #444;
  cursor: not-allowed;
  opacity: 0.5;
}

/* ===== OFFLINE INDICATORS ===== */
.offline-indicator {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 20px;
  height: 20px;
  font-size: 12px;
  cursor: pointer;
  flex-shrink: 0;
  user-select: none;
  -webkit-user-select: none;
  transition: opacity 0.2s;
  margin-right: 2px;
}
.oi-pinned { opacity: 1; }
.oi-cloud { opacity: 1; color: #4fc3f7; }
.oi-gray { opacity: 0.35; }
.oi-gray:hover { opacity: 0.6; }

/* Cloud context menu */
.cloud-menu {
  background: #1a1a2e;
  border: 1px solid rgba(255,255,255,0.15);
  border-radius: 10px;
  padding: 4px 0;
  min-width: 180px;
  box-shadow: 0 6px 24px rgba(0,0,0,0.5);
}
.cloud-menu-item {
  padding: 10px 16px;
  font-size: 13px;
  color: #ddd;
  cursor: pointer;
  transition: background 0.15s;
}
.cloud-menu-item:hover { background: rgba(255,255,255,0.08); }
.cloud-menu-danger { color: #ef5350; }
.cloud-menu-danger:hover { background: rgba(239,83,80,0.12); }

/* ===== OFFLINE BUTTON INDICATOR "!" ===== */
.offline-bang {
  position: absolute;
  left: -6px;
  top: -2px;
  background: #ef5350;
  color: #fff;
  font-size: 10px;
  font-weight: bold;
  width: 16px;
  height: 16px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  pointer-events: auto;
  cursor: pointer;
  animation: bangPulse 2s infinite;
}
@keyframes bangPulse {
  0%, 100% { transform: scale(1); }
  50% { transform: scale(1.15); }
}

/* ===== CACHE PROGRESS LAYER (ТЗ 15) ===== */
.progress-bar-container {
  position: relative;
}
#cache-progress-layer {
  position: absolute;
  bottom: 0;
  left: 0;
  height: 100%;
  background: rgba(79, 195, 247, 0.2);
  border-radius: inherit;
  width: 0%;
  transition: width 0.5s;
  pointer-events: none;
  z-index: 0;
}

/* ===== R3 INACTIVE TRACKS (ТЗ 11.2.I.10) ===== */
.track-row.r3-inactive {
  opacity: 0.4;
  filter: grayscale(0.6);
}
.track-row.r3-inactive:hover { opacity: 0.55; }

/* ===== RESPONSIVE ===== */
@media (max-width: 420px) {
  .ofl-content, .stats-content { max-width: 100%; border-radius: 10px; }
  .ofl-hdr, .stats-hdr { padding: 12px 14px 8px; }
  .ofl-body, .stats-body { padding: 8px 14px 14px; }
  .ofl-sec h3 { font-size: 13px; }
  .ofl-btn { font-size: 11px; padding: 6px 10px; }
}
